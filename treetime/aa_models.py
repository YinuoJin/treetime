from __future__ import division, print_function, absolute_import, absolute_import
import numpy as np
from .seq_utils import alphabets
from .gtr import GTR


def JTT92(mu=1.0):
    # stationary concentrations:
    pis = np.array([
        0.07674789,
        0.05169087,
        0.04264509,
        0.05154407,
        0.01980301,
        0.04075195,
        0.06182989,
        0.07315199,
        0.02294399,
        0.05376110,
        0.09190390,
        0.05867583,
        0.02382594,
        0.04012589,
        0.05090097,
        0.06876503,
        0.05856501,
        0.01426057,
        0.03210196,
        0.06600504])

    # attempt matrix (FIXME)
    Q = np.array([
    [-1.247831,0.044229,0.041179,0.061769,0.042704,0.043467,0.08007,0.136501,0.02059,0.027453,0.022877,0.02669,0.041179,0.011439,0.14794,0.288253,0.362223,0.006863,0.008388,0.227247 ],
    [0.029789,-1.025965,0.023112,0.008218,0.058038,0.159218,0.014895,0.070364,0.168463,0.011299,0.019517,0.33179,0.022599,0.002568,0.038007,0.051874,0.032871,0.064714,0.010272,0.008731 ],
    [0.022881,0.019068,-1.280568,0.223727,0.014407,0.03644,0.024576,0.034322,0.165676,0.019915,0.005085,0.11144,0.012712,0.004237,0.006356,0.213134,0.098304,0.00339,0.029661,0.00678 ],
    [0.041484,0.008194,0.270413,-1.044903,0.005121,0.025095,0.392816,0.066579,0.05736,0.005634,0.003585,0.013316,0.007682,0.002049,0.007682,0.030217,0.019462,0.002049,0.023559,0.015877 ],
    [0.011019,0.022234,0.00669,0.001968,-0.56571,0.001771,0.000984,0.011609,0.013577,0.003345,0.004526,0.001377,0.0061,0.015348,0.002755,0.043878,0.008264,0.022628,0.041124,0.012199 ],
    [0.02308,0.125524,0.034823,0.019841,0.003644,-1.04415,0.130788,0.010528,0.241735,0.003644,0.029154,0.118235,0.017411,0.00162,0.066406,0.021461,0.020651,0.007288,0.009718,0.008098 ],
    [0.064507,0.017816,0.035632,0.471205,0.003072,0.198435,-0.944343,0.073107,0.015973,0.007372,0.005529,0.111197,0.011058,0.003072,0.011058,0.01843,0.019659,0.006143,0.0043,0.027646 ],
    [0.130105,0.099578,0.058874,0.09449,0.042884,0.018898,0.086495,-0.647831,0.016717,0.004361,0.004361,0.019625,0.010176,0.003634,0.017444,0.146096,0.023986,0.039976,0.005815,0.034162 ],
    [0.006155,0.074775,0.089138,0.025533,0.01573,0.1361,0.005927,0.005243,-1.135695,0.003648,0.012767,0.010259,0.007523,0.009119,0.026217,0.016642,0.010487,0.001824,0.130629,0.002508 ],
    [0.01923,0.011752,0.025106,0.005876,0.009081,0.004808,0.00641,0.003205,0.008547,-1.273602,0.122326,0.011218,0.25587,0.047542,0.005342,0.021367,0.130873,0.004808,0.017094,0.513342 ],
    [0.027395,0.0347,0.010958,0.006392,0.021003,0.065748,0.008219,0.005479,0.051137,0.209115,-0.668139,0.012784,0.354309,0.226465,0.093143,0.053877,0.022829,0.047485,0.021916,0.16437 ],
    [0.020405,0.376625,0.153332,0.015158,0.004081,0.170239,0.105525,0.015741,0.026235,0.012243,0.008162,-0.900734,0.037896,0.002332,0.012243,0.027401,0.06005,0.00583,0.004664,0.008162 ],
    [0.012784,0.010416,0.007102,0.003551,0.007339,0.01018,0.004261,0.003314,0.007812,0.113397,0.091854,0.015388,-1.182051,0.01018,0.003788,0.006865,0.053503,0.005682,0.004261,0.076466 ],
    [0.00598,0.001993,0.003987,0.001595,0.031098,0.001595,0.001993,0.001993,0.015948,0.035484,0.098877,0.001595,0.017144,-0.637182,0.006778,0.03668,0.004784,0.021131,0.213701,0.024719 ],
    [0.098117,0.037426,0.007586,0.007586,0.007081,0.082944,0.009104,0.012138,0.058162,0.005058,0.051587,0.010621,0.008092,0.008598,-0.727675,0.144141,0.059679,0.003035,0.005058,0.011632 ],
    [0.258271,0.069009,0.343678,0.040312,0.152366,0.036213,0.020498,0.137334,0.049878,0.02733,0.040312,0.032113,0.019814,0.06286,0.194728,-1.447863,0.325913,0.023914,0.043045,0.025964 ],
    [0.276406,0.037242,0.135003,0.022112,0.02444,0.029677,0.018621,0.019203,0.026768,0.142567,0.014548,0.059936,0.131511,0.006983,0.068665,0.27757,-1.335389,0.006983,0.01222,0.065174 ],
    [0.001275,0.017854,0.001134,0.000567,0.016295,0.002551,0.001417,0.007793,0.001134,0.001275,0.007368,0.001417,0.003401,0.00751,0.00085,0.004959,0.0017,-0.312785,0.010061,0.003542 ],
    [0.003509,0.006379,0.022328,0.014673,0.066664,0.007655,0.002233,0.002552,0.182769,0.010207,0.007655,0.002552,0.005741,0.170967,0.00319,0.020095,0.006698,0.022647,-0.605978,0.005103 ],
    [0.195438,0.011149,0.010493,0.020331,0.040662,0.013117,0.029512,0.030824,0.007214,0.630254,0.11805,0.009182,0.211834,0.040662,0.015084,0.024922,0.073453,0.016396,0.010493,-1.241722]
    ])

    Spis = np.sqrt(pis[None, :] / pis[:,None])
    W = Q * Spis

    gtr = GTR(alphabet=alphabets['aa_nogap'])
    gtr.assign_rates(mu=mu, pi=pis, W=W)
    return gtr


####################################################################
#   Two-state EX mixture model
####################################################################

def BURIED(mu=1.0):
    """
    matrix of buried sites
    
    Parameters
    ----------
     mu: rate
    """
    pis = np.array([0.123119,0.019475,0.019852,0.018583,0.018711,0.017275,0.018723,0.050388,0.016402,0.119697,0.161399,0.012776,0.035838,0.057019,0.030913,0.043472,0.049935,0.012600,0.039929,0.133894])
    
    W = np.array([
        [0.0,0.338649,0.201335,0.283859,2.640244,0.543136,0.748479,2.700465,0.237686,0.044209,0.124047,0.433721,0.497479,0.093991,0.986621,5.925588,1.958501,0.068357,0.084768,1.387752],
        [0.338649,0.0,0.981635,0.247537,0.90473,4.570308,0.917979,0.539246,3.175221,0.099241,0.314159,17.781822,0.448773,0.05553,0.356417,0.979993,0.630713,0.784449,0.312038,0.140091],
        [0.201335,0.981635,0.0,6.505182,1.353325,2.439639,0.804756,0.810739,6.308043,0.162644,0.088243,2.851914,0.380964,0.098936,0.214521,4.725421,2.007592,0.109073,0.615093,0.112176],
        [0.283859,0.247537,6.505182,0.0,0.312005,0.682052,10.03031,0.810727,1.540002,0.020816,0.017526,0.459939,0.057176,0.02616,0.246129,1.15899,0.289641,0.08581,0.202611,0.058637],
        [2.640244,0.90473,1.353325,0.312005,0.0,0.216787,0.024055,0.70132,0.469875,0.166986,0.449241,0.117548,0.815999,0.662517,0.164228,5.111992,2.28414,0.45788,0.788164,1.575057],
        [0.543136,4.570308,2.439639,0.682052,0.216787,0.0,8.670112,0.330139,8.675492,0.082745,0.641784,6.815411,2.089412,0.091948,0.654039,1.120931,0.787821,0.297731,0.293543,0.203946],
        [0.748479,0.917979,0.804756,10.03031,0.024055,8.670112,0.0,0.636675,0.750683,0.030581,0.073392,3.482941,0.291379,0.02276,0.295079,0.737456,0.539892,0.155877,0.137306,0.239406],
        [2.700465,0.539246,0.810739,0.810727,0.70132,0.330139,0.636675,0.0,0.183743,0.005017,0.017752,0.484653,0.054491,0.034431,0.179095,2.27947,0.097432,0.157418,0.035497,0.044011],
        [0.237686,3.175221,6.308043,1.540002,0.469875,8.675492,0.750683,0.183743,0.0,0.07582,0.277023,1.247888,0.30745,0.675645,0.428213,0.886126,0.467489,0.708743,4.93833,0.085226],
        [0.044209,0.099241,0.162644,0.020816,0.166986,0.082745,0.030581,0.005017,0.07582,0.0,2.38376,0.161658,2.817174,0.521416,0.037671,0.051057,0.644041,0.054134,0.101803,6.427279],
        [0.124047,0.314159,0.088243,0.017526,0.449241,0.641784,0.073392,0.017752,0.277023,2.38376,0.0,0.219757,4.759683,1.672365,0.17078,0.089611,0.202812,0.374568,0.180086,1.035942],
        [0.433721,17.781822,2.851914,0.459939,0.117548,6.815411,3.482941,0.484653,1.247888,0.161658,0.219757,0.0,1.082403,0.077917,0.347219,0.925355,1.401676,0.115777,0.280737,0.244336],
        [0.497479,0.448773,0.380964,0.057176,0.815999,2.089412,0.291379,0.054491,0.30745,2.817174,4.759683,1.082403,0.0,1.296869,0.074086,0.275366,1.340732,0.477495,0.26454,1.033583],
        [0.093991,0.05553,0.098936,0.02616,0.662517,0.091948,0.02276,0.034431,0.675645,0.521416,1.672365,0.077917,1.296869,0.0,0.057233,0.274582,0.103118,2.362999,8.142914,0.27801],
        [0.986621,0.356417,0.214521,0.246129,0.164228,0.654039,0.295079,0.179095,0.428213,0.037671,0.17078,0.347219,0.074086,0.057233,0.0,1.151114,0.601281,0.047127,0.059308,0.213475],
        [5.925588,0.979993,4.725421,1.15899,5.111992,1.120931,0.737456,2.27947,0.886126,0.051057,0.089611,0.925355,0.275366,0.274582,1.151114,0.0,8.190534,0.209085,0.264401,0.079878],
        [1.958501,0.630713,2.007592,0.289641,2.28414,0.787821,0.539892,0.097432,0.467489,0.644041,0.202812,1.401676,1.340732,0.103118,0.601281,8.190534,0.0,0.097054,0.133054,1.59256],
        [0.068357,0.784449,0.109073,0.08581,0.45788,0.297731,0.155877,0.157418,0.708743,0.054134,0.374568,0.115777,0.477495,2.362999,0.047127,0.209085,0.097054,0.0,2.905674,0.081135],
        [0.084768,0.312038,0.615093,0.202611,0.788164,0.293543,0.137306,0.035497,4.93833,0.101803,0.180086,0.280737,0.26454,8.142914,0.059308,0.264401,0.133054,2.905674,0.0,0.108383],
        [1.387752,0.140091,0.112176,0.058637,1.575057,0.203946,0.239406,0.044011,0.085226,6.427279,1.035942,0.244336,1.033583,0.27801,0.213475,0.079878,1.59256,0.081135,0.108383,0.0]
    ])

    gtr = GTR(alphabet=alphabets['aa_nogap'])
    gtr.assign_rates(mu=mu, pi=pis, W=W)
    
    return gtr


def EXPOSED(mu=1.0):
    """
    matrix of exposed sites

    Parameters
    ----------
     mu: rate
    """
    pis = np.array([0.088367,0.078147,0.047163,0.087976,0.004517,0.058526,0.128039,0.056993,0.024856,0.025277,0.045202,0.094639,0.012338,0.016158,0.060124,0.055346,0.051290,0.006771,0.021554,0.036718])
    
    W = np.array([
        [0.0,0.526738,0.48315,0.658902,2.051872,1.280002,1.306565,1.370782,0.540809,0.171986,0.430511,0.697731,1.043937,0.265209,1.270693,4.826665,2.131819,0.143081,0.208643,2.544463],
        [0.526738,0.0,0.505837,0.051052,2.214326,2.039552,0.137928,0.363365,2.288922,0.237023,0.670514,3.881079,0.656943,0.097443,0.166534,0.751947,0.584329,0.47559,0.196271,0.313443],
        [0.48315,0.505837,0.0,3.902456,0.961103,1.301786,0.285806,1.8201,4.949307,0.337226,0.158937,1.677194,0.539827,0.182522,0.068692,4.412265,2.133604,0.061094,0.599369,0.172264],
        [0.658902,0.051052,3.902456,0.0,0.129989,0.399061,3.100403,0.885317,0.70089,0.018315,0.021949,0.10545,0.066925,0.026918,0.228829,0.975564,0.368887,0.042618,0.121313,0.073705],
        [2.051872,2.214326,0.961103,0.129989,0.0,0.456521,0.033946,0.886564,2.172284,1.037046,1.702066,0.146263,1.846562,3.002586,0.156216,5.294149,2.067387,1.603125,3.842632,4.207648],
        [1.280002,2.039552,1.301786,0.399061,0.456521,0.0,2.514377,0.320746,3.755421,0.212032,1.261113,2.570254,1.973592,0.080193,0.362501,1.033459,1.013613,0.210329,0.15847,0.497398],
        [1.306565,0.137928,0.285806,3.100403,0.033946,2.514377,0.0,0.303966,0.270957,0.084442,0.110508,0.730337,0.18816,0.023999,0.214847,0.382235,0.51139,0.048276,0.064648,0.48462],
        [1.370782,0.363365,1.8201,0.885317,0.886564,0.320746,0.303966,0.0,0.401311,0.012279,0.052946,0.279865,0.158136,0.084663,0.1489,1.970857,0.174527,0.186382,0.03928,0.132496],
        [0.540809,2.288922,4.949307,0.70089,2.172284,3.755421,0.270957,0.401311,0.0,0.317239,0.869247,0.598289,0.519993,2.047163,0.323141,0.99331,0.58096,0.961546,8.230282,0.329895],
        [0.171986,0.237023,0.337226,0.018315,1.037046,0.212032,0.084442,0.012279,0.317239,0.0,8.675343,0.338782,9.483497,2.193062,0.071992,0.190509,2.56363,0.208313,0.517123,23.711178],
        [0.430511,0.670514,0.158937,0.021949,1.702066,1.261113,0.110508,0.052946,0.869247,8.675343,0.0,0.313102,14.176858,4.802817,0.343919,0.389101,0.522334,1.130724,0.713426,3.466991],
        [0.697731,3.881079,1.677194,0.10545,0.146263,2.570254,0.730337,0.279865,0.598289,0.338782,0.313102,0.0,1.013268,0.044792,0.19547,0.592156,1.147459,0.052858,0.084962,0.348362],
        [1.043937,0.656943,0.539827,0.066925,1.846562,1.973592,0.18816,0.158136,0.519993,9.483497,14.176858,1.013268,0.0,3.261401,0.099252,0.557254,2.960091,1.328785,0.812142,4.136445],
        [0.265209,0.097443,0.182522,0.026918,3.002586,0.080193,0.023999,0.084663,2.047163,2.193062,4.802817,0.044792,3.261401,0.0,0.08702,0.668834,0.24442,5.210001,23.228875,1.199764],
        [1.270693,0.166534,0.068692,0.228829,0.156216,0.362501,0.214847,0.1489,0.323141,0.071992,0.343919,0.19547,0.099252,0.08702,0.0,1.223981,0.413148,0.045945,0.043249,0.368231],
        [4.826665,0.751947,4.412265,0.975564,5.294149,1.033459,0.382235,1.970857,0.99331,0.190509,0.389101,0.592156,0.557254,0.668834,1.223981,0.0,7.384701,0.316078,0.40531,0.266531],
        [2.131819,0.584329,2.133604,0.368887,2.067387,1.013613,0.51139,0.174527,0.58096,2.56363,0.522334,1.147459,2.960091,0.24442,0.413148,7.384701,0.0,0.144393,0.234217,3.184874],
        [0.143081,0.47559,0.061094,0.042618,1.603125,0.210329,0.048276,0.186382,0.961546,0.208313,1.130724,0.052858,1.328785,5.210001,0.045945,0.316078,0.144393,0.0,4.903887,0.252132],
        [0.208643,0.196271,0.599369,0.121313,3.842632,0.15847,0.064648,0.03928,8.230282,0.517123,0.713426,0.084962,0.812142,23.228875,0.043249,0.40531,0.234217,4.903887,0.0,0.459187],
        [2.544463,0.313443,0.172264,0.073705,4.207648,0.497398,0.48462,0.132496,0.329895,23.711178,3.466991,0.348362,4.136445,1.199764,0.368231,0.266531,3.184874,0.252132,0.459187,0.0]
    ])
    
    gtr = GTR(alphabet=alphabets['aa_nogap'])
    gtr.assign_rates(mu=mu, pi=pis, W=W)
    
    return gtr
    
    
####################################################################
#   Three-state EHO mixture model
####################################################################

def EXTENDED(mu=1.0):
    """
    matrix of extended sites

    Parameters
    ----------
     mu: rate
    """
    pis = np.array([0.062087,0.053435,0.023743,0.032063,0.013132,0.034151,0.061042,0.030664,0.022696,0.104732,0.099541,0.054991,0.022312,0.045996,0.025392,0.045673,0.072789,0.012691,0.043790,0.139079])
    
    W = np.array([
        [0.0,0.22175,0.256487,0.447755,4.89314,0.54266,0.549459,5.411319,0.283752,0.026683,0.226816,0.235513,0.992834,0.191967,1.876507,6.066032,1.827471,0.101419,0.091914,1.970427],
        [0.22175,0.0,0.595368,0.11231,0.929131,2.886791,0.290798,0.302948,2.760038,0.053027,0.251641,6.0173,0.351969,0.041219,0.395175,1.083228,0.645132,0.452274,0.112094,0.119016],
        [0.256487,0.595368,0.0,7.769815,1.061884,1.927072,0.518264,0.907713,5.159285,0.166715,0.062256,2.543177,0.415447,0.090517,0.36265,5.612711,1.883173,0.065206,0.451176,0.091863],
        [0.447755,0.11231,7.769815,0.0,0.164472,0.497273,5.393249,0.961651,0.978418,0.016491,0.015837,0.223507,0.041511,0.01481,0.550534,1.03554,0.287521,0.034173,0.108762,0.041044],
        [4.89314,0.929131,1.061884,0.164472,0.0,0.133291,0.003776,1.249183,0.737799,0.151942,0.763554,0.023575,1.271632,1.004694,0.174031,4.263932,1.395928,0.592031,1.183567,1.750822],
        [0.54266,2.886791,1.927072,0.497273,0.133291,0.0,4.326528,0.173873,5.086066,0.055934,0.537705,3.432847,1.700679,0.042779,0.731229,1.429211,1.013709,0.164037,0.132194,0.222903],
        [0.549459,0.290798,0.518264,5.393249,0.003776,4.326528,0.0,0.31678,0.421812,0.026726,0.042909,1.211039,0.111984,0.011177,0.412907,0.766802,0.78108,0.049674,0.042952,0.225961],
        [5.411319,0.302948,0.907713,0.961651,1.249183,0.173873,0.31678,0.0,0.209276,0.00178,0.032938,0.160545,0.117596,0.040989,0.205341,2.266299,0.05514,0.183473,0.030418,0.053387],
        [0.283752,2.760038,5.159285,0.978418,0.737799,5.086066,0.421812,0.209276,0.0,0.098605,0.321607,0.671045,0.326393,0.641267,0.381717,1.074108,0.512,0.741383,4.37336,0.123318],
        [0.026683,0.053027,0.166715,0.016491,0.151942,0.055934,0.026726,0.00178,0.098605,0.0,3.217159,0.082221,3.329162,0.813011,0.011597,0.047896,0.588357,0.069289,0.122828,6.815243],
        [0.226816,0.251641,0.062256,0.015837,0.763554,0.537705,0.042909,0.032938,0.321607,3.217159,0.0,0.106179,7.496635,2.233318,0.315127,0.147065,0.142327,0.429275,0.186938,1.427658],
        [0.235513,6.0173,2.543177,0.223507,0.023575,3.432847,1.211039,0.160545,0.671045,0.082221,0.106179,0.0,0.519821,0.023173,0.393303,0.683291,1.256445,0.050856,0.096667,0.124284],
        [0.992834,0.351969,0.415447,0.041511,1.271632,1.700679,0.111984,0.117596,0.326393,3.329162,7.496635,0.519821,0.0,1.863238,0.13536,0.352118,1.435179,0.545447,0.344096,1.427074],
        [0.191967,0.041219,0.090517,0.01481,1.004694,0.042779,0.011177,0.040989,0.641267,0.813011,2.233318,0.023173,1.863238,0.0,0.043846,0.382422,0.079647,2.17851,8.276255,0.341263],
        [1.876507,0.395175,0.36265,0.550534,0.174031,0.731229,0.412907,0.205341,0.381717,0.011597,0.315127,0.393303,0.13536,0.043846,0.0,1.462674,0.417388,0.02277,0.053251,0.127045],
        [6.066032,1.083228,5.612711,1.03554,4.263932,1.429211,0.766802,2.266299,1.074108,0.047896,0.147065,0.683291,0.352118,0.382422,1.462674,0.0,6.092548,0.304839,0.325231,0.076658],
        [1.827471,0.645132,1.883173,0.287521,1.395928,1.013709,0.78108,0.05514,0.512,0.588357,0.142327,1.256445,1.435179,0.079647,0.417388,6.092548,0.0,0.111242,0.13531,1.052442],
        [0.101419,0.452274,0.065206,0.034173,0.592031,0.164037,0.049674,0.183473,0.741383,0.069289,0.429275,0.050856,0.545447,2.17851,0.02277,0.304839,0.111242,0.0,2.597897,0.073165],
        [0.091914,0.112094,0.451176,0.108762,1.183567,0.132194,0.042952,0.030418,4.37336,0.122828,0.186938,0.096667,0.344096,8.276255,0.053251,0.325231,0.13531,2.597897,0.0,0.101733],
        [1.970427,0.119016,0.091863,0.041044,1.750822,0.222903,0.225961,0.053387,0.123318,6.815243,1.427658,0.124284,1.427074,0.341263,0.127045,0.076658,1.052442,0.073165,0.101733,0.0]
    ])
    
    gtr = GTR(alphabet=alphabets['aa_nogap'])
    gtr.assign_rates(mu=mu, pi=pis, W=W)
    
    return gtr
    
    
def HELIX(mu=1.0):
    """
    matrix of helix sites

    Parameters
    ----------
     mu: rate
    """
    pis = np.array([0.121953,0.076798,0.032215,0.066765,0.006842,0.061304,0.131841,0.026596,0.020392,0.047287,0.087919,0.084679,0.020970,0.024145,0.025871,0.042103,0.038715,0.008346,0.023841,0.051421])
    
    W = np.array([
        [0.0,0.346476,0.374362,0.557349,3.192474,0.776545,0.841893,4.037113,0.394225,0.11135,0.193017,0.481682,0.610432,0.147278,1.090575,6.243684,2.847158,0.090983,0.152848,2.140511],
        [0.346476,0.0,0.66487,0.079157,1.027228,1.90286,0.158406,0.661209,2.12376,0.099645,0.307622,3.827872,0.344033,0.035167,0.181605,0.836138,0.566364,0.369015,0.170981,0.136453],
        [0.374362,0.66487,0.0,3.710526,0.891196,1.561002,0.443065,1.866962,5.845902,0.233216,0.115495,1.926308,0.452639,0.106276,0.093658,5.633664,2.984732,0.085583,0.594708,0.145376],
        [0.557349,0.079157,3.710526,0.0,0.006722,0.51736,3.792847,1.144918,0.737868,0.005627,0.009651,0.163314,0.035659,0.018468,0.38649,0.952131,0.347047,0.046821,0.106099,0.046174],
        [3.192474,1.027228,0.891196,0.006722,0.0,0.112028,0.000006,1.46554,1.084909,0.839533,1.136538,0.021755,1.624032,1.864906,0.097655,6.398291,3.711971,0.950521,2.051641,4.011687],
        [0.776545,1.90286,1.561002,0.51736,0.112028,0.0,2.320685,0.511489,3.960964,0.089484,0.584189,2.487895,1.146169,0.047207,0.462559,1.267404,1.083181,0.183299,0.121416,0.191618],
        [0.841893,0.158406,0.443065,3.792847,0.000006,2.320685,0.0,0.573208,0.270146,0.01952,0.039838,0.768919,0.103241,0.010268,0.290152,0.430602,0.4957,0.040785,0.047614,0.192292],
        [4.037113,0.661209,1.866962,1.144918,1.46554,0.511489,0.573208,0.0,0.380762,0.021251,0.048105,0.327002,0.171164,0.086543,0.568098,5.463144,0.500029,0.391093,0.064377,0.202844],
        [0.394225,2.12376,5.845902,0.737868,1.084909,3.960964,0.270146,0.380762,0.0,0.132153,0.485901,0.534206,0.364836,1.244539,0.458437,1.088326,0.642773,0.950288,8.167042,0.174981],
        [0.11135,0.099645,0.233216,0.005627,0.839533,0.089484,0.01952,0.021251,0.132153,0.0,4.915707,0.147053,6.260678,0.927331,0.043237,0.102127,1.698955,0.07578,0.19554,14.46084],
        [0.193017,0.307622,0.115495,0.009651,1.136538,0.584189,0.039838,0.048105,0.485901,4.915707,0.0,0.136159,7.738615,3.243633,0.20746,0.19386,0.402699,0.624335,0.352598,2.175028],
        [0.481682,3.827872,1.926308,0.163314,0.021755,2.487895,0.768919,0.327002,0.534206,0.147053,0.136159,0.0,0.549401,0.016265,0.198291,0.707365,1.111399,0.041505,0.069186,0.136317],
        [0.610432,0.344033,0.452639,0.035659,1.624032,1.146169,0.103241,0.171164,0.364836,6.260678,7.738615,0.549401,0.0,2.326533,0.061027,0.438507,2.483456,0.980672,0.465779,2.393838],
        [0.147278,0.035167,0.106276,0.018468,1.864906,0.047207,0.010268,0.086543,1.244539,0.927331,3.243633,0.016265,2.326533,0.0,0.067592,0.47062,0.231119,3.915972,15.178886,0.659302],
        [1.090575,0.181605,0.093658,0.38649,0.097655,0.462559,0.290152,0.568098,0.458437,0.043237,0.20746,0.198291,0.061027,0.067592,0.0,1.534272,0.685164,0.053806,0.058255,0.418505],
        [6.243684,0.836138,5.633664,0.952131,6.398291,1.267404,0.430602,5.463144,1.088326,0.102127,0.19386,0.707365,0.438507,0.47062,1.534272,0.0,8.832473,0.299723,0.405459,0.180248],
        [2.847158,0.566364,2.984732,0.347047,3.711971,1.083181,0.4957,0.500029,0.642773,1.698955,0.402699,1.111399,2.483456,0.231119,0.685164,8.832473,0.0,0.100663,0.201603,3.585329],
        [0.090983,0.369015,0.085583,0.046821,0.950521,0.183299,0.040785,0.391093,0.950288,0.07578,0.624335,0.041505,0.980672,3.915972,0.053806,0.299723,0.100663,0.0,4.035822,0.175143],
        [0.152848,0.170981,0.594708,0.106099,2.051641,0.121416,0.047614,0.064377,8.167042,0.19554,0.352598,0.069186,0.465779,15.178886,0.058255,0.405459,0.201603,4.035822,0.0,0.281722],
        [2.140511,0.136453,0.145376,0.046174,4.011687,0.191618,0.192292,0.202844,0.174981,14.46084,2.175028,0.136317,2.393838,0.659302,0.418505,0.180248,3.585329,0.175143,0.281722,0.0]
    ])

    gtr = GTR(alphabet=alphabets['aa_nogap'])
    gtr.assign_rates(mu=mu, pi=pis, W=W)
    
    return gtr
    
    
def OTHER(mu=1.0):
    """
    matrix of other sites

    Parameters
    ----------
     mu: rate
    """
    pis = np.array([0.076458,0.052393,0.055429,0.088634,0.007473,0.040671,0.080952,0.100192,0.025439,0.031730,0.053100,0.070835,0.014039,0.023159,0.087111,0.063636,0.055346,0.007033,0.023779,0.042590])
    
    W = np.array([
        [0.0,0.529263,0.379476,0.516691,3.77489,1.312262,1.403437,1.272402,0.558733,0.124057,0.340362,0.706732,1.056749,0.233961,1.51883,5.595735,2.157458,0.151895,0.219509,3.049976],
        [0.529263,0.0,0.612335,0.067732,1.615176,2.913667,0.15446,0.389317,2.816641,0.15508,0.580087,5.734632,0.665355,0.079465,0.252482,0.861017,0.613623,0.544292,0.243507,0.27874],
        [0.379476,0.612335,0.0,4.012914,0.888663,1.533683,0.333334,1.243222,4.803,0.219635,0.119838,1.847806,0.399943,0.130295,0.049484,3.749627,1.73338,0.060182,0.580103,0.13412],
        [0.516691,0.067732,4.012914,0.0,0.16581,0.442262,3.815893,0.661976,0.761339,0.019097,0.015948,0.128114,0.0539,0.016768,0.171011,0.987083,0.361861,0.043433,0.130214,0.055382],
        [3.77489,1.615176,0.888663,0.16581,0.0,0.337571,0.015567,0.554904,1.223662,0.560959,1.192857,0.050896,1.893946,1.902244,0.108909,4.952776,2.145775,1.259614,2.325021,4.149385],
        [1.312262,2.913667,1.533683,0.442262,0.337571,0.0,3.743866,0.332656,4.889028,0.100743,1.156516,3.616626,2.299714,0.077611,0.501196,1.045071,1.011592,0.228038,0.19658,0.500946],
        [1.403437,0.15446,0.333334,3.815893,0.015567,3.743866,0.0,0.31977,0.323617,0.038076,0.083154,1.131071,0.168079,0.012655,0.3466,0.463265,0.523086,0.045082,0.07966,0.435957],
        [1.272402,0.389317,1.243222,0.661976,0.554904,0.332656,0.31977,0.0,0.300981,0.005599,0.031031,0.28395,0.085094,0.048906,0.058913,1.190738,0.091023,0.134804,0.037482,0.06717],
        [0.558733,2.816641,4.803,0.761339,1.223662,4.889028,0.323617,0.300981,0.0,0.184752,0.646292,0.643558,0.556024,1.403178,0.299924,0.897478,0.450662,0.748147,6.907609,0.214393],
        [0.124057,0.15508,0.219635,0.019097,0.560959,0.100743,0.038076,0.005599,0.184752,0.0,7.873544,0.179831,8.136055,1.581816,0.073007,0.131753,1.492403,0.134416,0.299245,22.435652],
        [0.340362,0.580087,0.119838,0.015948,1.192857,1.156516,0.083154,0.031031,0.646292,7.873544,0.0,0.22432,14.213193,4.275863,0.297573,0.265701,0.408418,0.979277,0.552917,2.883298],
        [0.706732,5.734632,1.847806,0.128114,0.050896,3.616626,1.131071,0.28395,0.643558,0.179831,0.22432,0.0,0.931689,0.036062,0.249478,0.607097,1.143233,0.038787,0.067894,0.323886],
        [1.056749,0.665355,0.399943,0.0539,1.893946,2.299714,0.168079,0.085094,0.556024,8.136055,14.213193,0.931689,0.0,2.888633,0.091619,0.399537,2.378569,0.908253,0.68525,3.369448],
        [0.233961,0.079465,0.130295,0.016768,1.902244,0.077611,0.012655,0.048906,1.403178,1.581816,4.275863,0.036062,2.888633,0.0,0.06892,0.408758,0.131777,4.850762,19.404995,0.722571],
        [1.51883,0.252482,0.049484,0.171011,0.108909,0.501196,0.3466,0.058913,0.299924,0.073007,0.297573,0.249478,0.091619,0.06892,0.0,0.993614,0.381007,0.052415,0.047839,0.315978],
        [5.595735,0.861017,3.749627,0.987083,4.952776,1.045071,0.463265,1.190738,0.897478,0.131753,0.265701,0.607097,0.399537,0.408758,0.993614,0.0,7.57434,0.249753,0.323207,0.152899],
        [2.157458,0.613623,1.73338,0.361861,2.145775,1.011592,0.523086,0.091023,0.450662,1.492403,0.408418,1.143233,2.378569,0.131777,0.381007,7.57434,0.0,0.114232,0.183044,2.423398],
        [0.151895,0.544292,0.060182,0.043433,1.259614,0.228038,0.045082,0.134804,0.748147,0.134416,0.979277,0.038787,0.908253,4.850762,0.052415,0.249753,0.114232,0.0,4.704884,0.186495],
        [0.219509,0.243507,0.580103,0.130214,2.325021,0.19658,0.07966,0.037482,6.907609,0.299245,0.552917,0.067894,0.68525,19.404995,0.047839,0.323207,0.183044,4.704884,0.0,0.303833],
        [3.049976,0.27874,0.13412,0.055382,4.149385,0.500946,0.435957,0.06717,0.214393,22.435652,2.883298,0.323886,3.369448,0.722571,0.315978,0.152899,2.423398,0.186495,0.303833,0.0]
    ])
    
    print(np.allclose(W, W.T))
    gtr = GTR(alphabet=alphabets['aa_nogap'])
    gtr.assign_rates(mu=mu, pi=pis, W=W)
    
    return gtr
    

####################################################################
#   other empirical models
####################################################################

_WAG01_pis = np.array([0.0866279,0.043972, 0.0390894,0.0570451,0.0193078,0.0367281,0.0580589,0.0832518,0.0244314,0.048466, 0.086209, 0.0620286,0.0195027,0.0384319,0.0457631,0.0695179,0.0610127,0.0143859,0.0352742,0.0708956])

_WAG01_matrix = np.array([
    [-1.117151, 0.050147, 0.046354, 0.067188, 0.093376, 0.082607, 0.143908, 0.128804, 0.028817, 0.017577, 0.036177, 0.082395, 0.081234, 0.019138, 0.130789, 0.306463, 0.192846, 0.010286, 0.021887, 0.182381],
    [0.025455, -0.974318, 0.029321, 0.006798, 0.024376, 0.140086, 0.020267, 0.026982, 0.098628, 0.008629, 0.022967, 0.246964, 0.031527, 0.004740, 0.031358, 0.056495, 0.025586, 0.053714, 0.017607, 0.011623],
    [0.020916, 0.026065, -1.452438, 0.222741, 0.010882, 0.063328, 0.038859, 0.046176, 0.162306, 0.022737, 0.005396, 0.123567, 0.008132, 0.003945, 0.008003, 0.163042, 0.083283, 0.002950, 0.044553, 0.008051],
    [0.044244, 0.008819, 0.325058, -0.989665, 0.001814, 0.036927, 0.369645, 0.051822, 0.055719, 0.002361, 0.005077, 0.028729, 0.006212, 0.002798, 0.025384, 0.064166, 0.022443, 0.007769, 0.019500, 0.009120],
    [0.020812, 0.010703, 0.005375, 0.000614, -0.487357, 0.002002, 0.000433, 0.006214, 0.005045, 0.003448, 0.007787, 0.001500, 0.007913, 0.008065, 0.002217, 0.028525, 0.010395, 0.014531, 0.011020, 0.020307],
    [0.035023, 0.117008, 0.059502, 0.023775, 0.003809, -1.379785, 0.210830, 0.012722, 0.165524, 0.004391, 0.033516, 0.150135, 0.059565, 0.003852, 0.035978, 0.039660, 0.033070, 0.008316, 0.008777, 0.011613],
    [0.096449, 0.026759, 0.057716, 0.376214, 0.001301, 0.333275, -1.236894, 0.034593, 0.034734, 0.007763, 0.009400, 0.157479, 0.019202, 0.004944, 0.041578, 0.042955, 0.050134, 0.009540, 0.011961, 0.035874],
    [0.123784, 0.051085, 0.098345, 0.075630, 0.026795, 0.028838, 0.049604, -0.497615, 0.021792, 0.002661, 0.005356, 0.032639, 0.015212, 0.004363, 0.021282, 0.117240, 0.019732, 0.029444, 0.009052, 0.016361],
    [0.008127, 0.054799, 0.101443, 0.023863, 0.006384, 0.110105, 0.014616, 0.006395, -0.992342, 0.003543, 0.012807, 0.022832, 0.010363, 0.017420, 0.017851, 0.018979, 0.012136, 0.006733, 0.099319, 0.003035],
    [0.009834, 0.009511, 0.028192, 0.002006, 0.008654, 0.005794, 0.006480, 0.001549, 0.007029, -1.233162, 0.161294, 0.016472, 0.216559, 0.053891, 0.005083, 0.016249, 0.074170, 0.010808, 0.021372, 0.397837],
    [0.036002, 0.045028, 0.011900, 0.007673, 0.034769, 0.078669, 0.013957, 0.005547, 0.045190, 0.286902, -0.726011, 0.023303, 0.439180, 0.191376, 0.037625, 0.031191, 0.029552, 0.060196, 0.036066, 0.162890],
    [0.058998, 0.348377, 0.196082, 0.031239, 0.004820, 0.253558, 0.168246, 0.024319, 0.057967, 0.021081, 0.016767, -1.124580, 0.060821, 0.005783, 0.036254, 0.062960, 0.090292, 0.008952, 0.008675, 0.019884],
    [0.018288, 0.013983, 0.004057, 0.002124, 0.007993, 0.031629, 0.006450, 0.003564, 0.008272, 0.087143, 0.099354, 0.019123, -1.322098, 0.024370, 0.003507, 0.010109, 0.031033, 0.010556, 0.008769, 0.042133],
    [0.008490, 0.004143, 0.003879, 0.001885, 0.016054, 0.004030, 0.003273, 0.002014, 0.027402, 0.042734, 0.085315, 0.003583, 0.048024, -0.713669, 0.006512, 0.022020, 0.006934, 0.061698, 0.260332, 0.026213],
    [0.069092, 0.032635, 0.009370, 0.020364, 0.005255, 0.044829, 0.032773, 0.011698, 0.033438, 0.004799, 0.019973, 0.026747, 0.008229, 0.007754, -0.605590, 0.077484, 0.038202, 0.006695, 0.010376, 0.015124],
    [0.245933, 0.089317, 0.289960, 0.078196, 0.102703, 0.075066, 0.051432, 0.097899, 0.054003, 0.023306, 0.025152, 0.070562, 0.036035, 0.039831, 0.117705, -1.392239, 0.319421, 0.038212, 0.057419, 0.016981],
    [0.135823, 0.035501, 0.129992, 0.024004, 0.032848, 0.054936, 0.052685, 0.014461, 0.030308, 0.093371, 0.020915, 0.088814, 0.097083, 0.011008, 0.050931, 0.280341, -1.154973, 0.007099, 0.018643, 0.088894],
    [0.001708, 0.017573, 0.001086, 0.001959, 0.010826, 0.003257, 0.002364, 0.005088, 0.003964, 0.003208, 0.010045, 0.002076, 0.007786, 0.023095, 0.002105, 0.007908, 0.001674, -0.466694, 0.037525, 0.005516],
    [0.008912, 0.014125, 0.040205, 0.012058, 0.020133, 0.008430, 0.007267, 0.003836, 0.143398, 0.015555, 0.014757, 0.004934, 0.015861, 0.238943, 0.007998, 0.029135, 0.010779, 0.092011, -0.726275, 0.011652],
    [0.149259, 0.018739, 0.014602, 0.011335, 0.074565, 0.022417, 0.043805, 0.013932, 0.008807, 0.581952, 0.133956, 0.022726, 0.153161, 0.048356, 0.023429, 0.017317, 0.103293, 0.027186, 0.023418, -1.085487]
    ])


_BLOSUM45 = np.array([
        [0, 1.31097856157468, 1.06573001937323, 1.2682782988532, 0.90471293383305, 1.05855446876905, 1.05232790675508, 0.769574440593014, 1.27579668305679, 0.964604099952603, 0.987178199640556, 1.05007594438157, 1.05464162250736, 1.1985987403937, 0.967404475245526, 0.700490199584332, 0.880060189098976, 1.09748548316685, 1.28141710375267, 0.800038509951648],
        [1.31097856157468, 0, 0.8010890222701, 0.953340718498495, 1.36011107208122, 0.631543775840481, 0.791014908659279, 1.15694899265629, 0.761152570032029, 1.45014917711188, 1.17792001455227, 0.394661075648738, 0.998807558909651, 1.135143404599, 1.15432562628921, 1.05309036790541, 1.05010474413616, 1.03938321130789, 0.963216908696184, 1.20274751778601],
        [1.06573001937323, 0.8010890222701, 0, 0.488217214273568, 1.10567116937273, 0.814970207038261, 0.810176440932339, 0.746487413974582, 0.61876156253224, 1.17886558630004, 1.52003670190022, 0.808442678243754, 1.2889025816028, 1.16264109995678, 1.18228799147301, 0.679475681649858, 0.853658619686283, 1.68988558988005, 1.24297493464833, 1.55207513886163],
        [1.2682782988532, 0.953340718498495, 0.488217214273568, 0, 1.31581050011876, 0.769778474953791, 0.482077627352988, 0.888361752320536, 0.736360849050364, 1.76756333403346, 1.43574761894039, 0.763612910719347, 1.53386612356483, 1.74323672079854, 0.886347403928663, 0.808614044804528, 1.01590147813779, 1.59617804551619, 1.1740494822217, 1.46600946033173],
        [0.90471293383305, 1.36011107208122, 1.10567116937273, 1.31581050011876, 0, 1.3836789310481, 1.37553994252576, 1.26740695314856, 1.32361065635259, 1.26087264215993, 1.02417540515351, 1.37259631233791, 1.09416720447891, 0.986982088723923, 1.59321190226694, 0.915638787768407, 0.913042853922533, 1.80744143643002, 1.3294417177004, 0.830022143283238],
        [1.05855446876905, 0.631543775840481, 0.814970207038261, 0.769778474953791, 1.3836789310481, 0, 0.506942797642807, 1.17699648087288, 0.614595446514896, 1.17092829494457, 1.19833088638994, 0.637341078675405, 0.806490842729072, 1.83315144709714, 0.932064479113502, 0.850321696813199, 1.06830084665916, 1.05739353225849, 0.979907428113788, 1.5416250309563],
        [1.05232790675508, 0.791014908659279, 0.810176440932339, 0.482077627352988, 1.37553994252576, 0.506942797642807, 0, 1.17007322676118, 0.769786956320484, 1.46659942462342, 1.19128214039009, 0.633592151371708, 1.27269395724349, 1.44641491621774, 0.735428579892476, 0.845319988414402, 1.06201695511881, 1.324395996498, 1.22734387448031, 1.53255698189437],
        [0.769574440593014, 1.15694899265629, 0.746487413974582, 0.888361752320536, 1.26740695314856, 1.17699648087288, 1.17007322676118, 0, 1.1259007054424, 1.7025415585924, 1.38293205218175, 1.16756929156758, 1.17264582493965, 1.33271035269688, 1.07564768421292, 0.778868281341681, 1.23287107008366, 0.968539655354582, 1.42479529031801, 1.41208067821187],
        [1.27579668305679, 0.761152570032029, 0.61876156253224, 0.736360849050364, 1.32361065635259, 0.614595446514896, 0.769786956320484, 1.1259007054424, 0, 1.4112324673522, 1.14630894167097, 0.967795284542623, 0.771479459384692, 1.10468029976148, 1.12334774065132, 1.02482926701639, 1.28754326478771, 1.27439749294131, 0.468683841672724, 1.47469999960758],
        [0.964604099952603, 1.45014917711188, 1.17886558630004, 1.76756333403346, 1.26087264215993, 1.17092829494457, 1.46659942462342, 1.7025415585924, 1.4112324673522, 0, 0.433350517223017, 1.463460928818, 0.462965544381851, 0.66291968000662, 1.07010201755441, 1.23000200130049, 0.973485453109068, 0.963546200571036, 0.708724769805536, 0.351200119909572],
        [0.987178199640556, 1.17792001455227, 1.52003670190022, 1.43574761894039, 1.02417540515351, 1.19833088638994, 1.19128214039009, 1.38293205218175, 1.14630894167097, 0.433350517223017, 0, 1.49770950074319, 0.473800072611076, 0.538473125003292, 1.37979627224964, 1.5859723170438, 0.996267398224516, 0.986095542821092, 0.725310666139274, 0.570542199221932],
        [1.05007594438157, 0.394661075648738, 0.808442678243754, 0.763612910719347, 1.37259631233791, 0.637341078675405, 0.633592151371708, 1.16756929156758, 0.967795284542623, 1.463460928818, 1.49770950074319, 0, 1.0079761868248, 1.44331961488922, 0.924599080166146, 1.06275728888356, 1.05974425835993, 1.04892430642749, 0.972058829603409, 1.21378822764856],
        [1.05464162250736, 0.998807558909651, 1.2889025816028, 1.53386612356483, 1.09416720447891, 0.806490842729072, 1.27269395724349, 1.17264582493965, 0.771479459384692, 0.462965544381851, 0.473800072611076, 1.0079761868248, 0, 0.72479754849538, 1.1699868662153, 1.34481214251794, 1.06435197383538, 1.05348497728858, 0.774878150710318, 0.609532859331199],
        [1.1985987403937, 1.135143404599, 1.16264109995678, 1.74323672079854, 0.986982088723923, 1.83315144709714, 1.44641491621774, 1.33271035269688, 1.10468029976148, 0.66291968000662, 0.538473125003292, 1.44331961488922, 0.72479754849538, 0, 1.32968844979665, 1.21307373491949, 0.960087571600877, 0.475142555482979, 0.349485367759138, 0.692733248746636],
        [0.967404475245526, 1.15432562628921, 1.18228799147301, 0.886347403928663, 1.59321190226694, 0.932064479113502, 0.735428579892476, 1.07564768421292, 1.12334774065132, 1.07010201755441, 1.37979627224964, 0.924599080166146, 1.1699868662153, 1.32968844979665, 0, 0.979087429691819, 0.97631161216338, 1.21751652292503, 1.42156458605332, 1.40887880416009],
        [0.700490199584332, 1.05309036790541, 0.679475681649858, 0.808614044804528, 0.915638787768407, 0.850321696813199, 0.845319988414402, 0.778868281341681, 1.02482926701639, 1.23000200130049, 1.5859723170438, 1.06275728888356, 1.34481214251794, 1.21307373491949, 0.979087429691819, 0, 0.56109848274013, 1.76318885009194, 1.29689226231656, 1.02015839286433],
        [0.880060189098976, 1.05010474413616, 0.853658619686283, 1.01590147813779, 0.913042853922533, 1.06830084665916, 1.06201695511881, 1.23287107008366, 1.28754326478771, 0.973485453109068, 0.996267398224516, 1.05974425835993, 1.06435197383538, 0.960087571600877, 0.97631161216338, 0.56109848274013, 0, 1.39547634461879, 1.02642577026706, 0.807404666228614],
        [1.09748548316685, 1.03938321130789, 1.68988558988005, 1.59617804551619, 1.80744143643002, 1.05739353225849, 1.324395996498, 0.968539655354582, 1.27439749294131, 0.963546200571036, 0.986095542821092, 1.04892430642749, 1.05348497728858, 0.475142555482979, 1.21751652292503, 1.76318885009194, 1.39547634461879, 0, 0.320002937404137, 1.268589159299],
        [1.28141710375267, 0.963216908696184, 1.24297493464833, 1.1740494822217, 1.3294417177004, 0.979907428113788, 1.22734387448031, 1.42479529031801, 0.468683841672724, 0.708724769805536, 0.725310666139274, 0.972058829603409, 0.774878150710318, 0.349485367759138, 1.42156458605332, 1.29689226231656, 1.02642577026706, 0.320002937404137, 0, 0.933095433689795],
        [0.800038509951648, 1.20274751778601, 1.55207513886163, 1.46600946033173, 0.830022143283238, 1.5416250309563, 1.53255698189437, 1.41208067821187, 1.47469999960758, 0.351200119909572, 0.570542199221932, 1.21378822764856, 0.609532859331199, 0.692733248746636, 1.40887880416009, 1.02015839286433, 0.807404666228614, 1.268589159299, 0.933095433689795]
    ])